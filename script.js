(function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},i=function(t,e){return(+t%(e=+e)+e)%e};document.addEventListener("DOMContentLoaded",function(){var e;return e=new t,e.start()}),t=function(){function t(){this.save_data=e(this.save_data,this),this.reset=e(this.reset,this),this.stop=e(this.stop,this),this.update_elapsed_time=e(this.update_elapsed_time,this),this.set_interval=e(this.set_interval,this),this.redraw_timers=e(this.redraw_timers,this),this.timer_resume=e(this.timer_resume,this),this.timer_go=e(this.timer_go,this),this.onclick=e(this.onclick,this),this.bind_events_listeners=e(this.bind_events_listeners,this),this.build_html=e(this.build_html,this),this.start=e(this.start,this),this.data=null!=localStorage.tempora?JSON.parse(localStorage.tempora):t["default"],this.interval=null}return t["default"]={active_timer:null,timers:[{id:"work",name:"Делу время",minutes_elapsed:0,started_timestamp:0},{id:"fun",name:"Потехе час",minutes_elapsed:0,started_timestamp:0}]},t.prototype.start=function(){return this.build_html(),this.data.active_timer&&this.timer_resume(this.data.active_timer),this.bind_events_listeners()},t.prototype.build_html=function(){var t,e,i,s,a,r,n;for(a=this.data.timers,r=[],e=i=0,s=a.length;s>i;e=++i)n=a[e],t='<div class="timer-wrap" id="'+n.id+'">\n  <div class="timer-inner">\n      <h2>\n          '+n.name+'\n      </h2>\n      <span class="elapsed-time">'+this.format_time(n.minutes_elapsed)+'</span>\n      <div class="timer-controls">\n          <button type="button" data-i="'+e+'" class="go">Go</button>\n      </div>\n  </div>\n</div>',r.push(document.body.insertAdjacentHTML("beforeend",t));return r},t.prototype.bind_events_listeners=function(){return document.addEventListener("click",this.onclick)},t.prototype.onclick=function(t){return"BUTTON"===t.target.tagName&&(t.target.classList.contains("go")&&this.timer_go(t.target.getAttribute("data-i")),t.target.classList.contains("reset")&&this.reset(),t.target.classList.contains("stop"))?this.stop():void 0},t.prototype.timer_go=function(t){return this.data.active_timer=t,this.data.timers[t].started_timestamp=Date.now(),this.save_data(),this.redraw_timers(),this.set_interval()},t.prototype.timer_resume=function(t){return this.update_elapsed_time(t),this.save_data(),this.redraw_timers(),this.set_interval()},t.prototype.redraw_timers=function(){var t,e,i,s,a,r;for(a=this.data.timers,e=i=0,s=a.length;s>i;e=++i)r=a[e],t=document.getElementById(r.id),t.querySelectorAll(".elapsed-time").item(0).textContent=this.format_time(r.minutes_elapsed),e!==this.data.active_timer&&(document.body.classList.remove(r.id),t.classList.remove("active"),t.querySelectorAll(".go").item(0).disabled=!1);return this.data.active_timer?(document.body.classList.add(this.data.timers[this.data.active_timer].id),t=document.getElementById(this.data.timers[this.data.active_timer].id),t.classList.add("active"),t.querySelectorAll("button").item(0).disabled=!0,document.getElementById("stop").disabled=!1):document.getElementById("stop").disabled=!0},t.prototype.format_time=function(t){var e,s;return e=Math.floor(t/60),s=i(t,60),(10>e?"0"+e:e)+":"+(10>s?"0"+s:s)},t.prototype.set_interval=function(){return this.interval&&clearInterval(this.interval),this.interval=setInterval(function(t){return function(){return t.update_elapsed_time(t.data.active_timer)}}(this),6e4)},t.prototype.update_elapsed_time=function(t){var e;return e=Math.round((Date.now()-this.data.timers[t].started_timestamp)/1e3),this.data.timers[t].minutes_elapsed=Math.ceil(e/60),this.save_data(),this.redraw_timers()},t.prototype.stop=function(){return this.interval&&clearInterval(this.interval),this.data.active_timer=null,this.save_data(),this.redraw_timers()},t.prototype.reset=function(){return this.interval&&clearInterval(this.interval),this.data=t["default"],this.save_data(),this.redraw_timers()},t.prototype.save_data=function(){return localStorage.tempora=JSON.stringify(this.data)},t}()}).call(this);